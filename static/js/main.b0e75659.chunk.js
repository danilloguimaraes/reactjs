(window.webpackJsonpweb=window.webpackJsonpweb||[]).push([[0],{103:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),o=a.n(i),s=(a(103),a(7)),l=a(8),c=a(12),u=a(10),m=a(5),h=a(11),d=(a(78),a(17)),f=a(60),b=a.n(f),v=(a(104),a(106),{apiKey:"AIzaSyABV35W-LGbtEVMZNVKFtHO9fczQp_b-yY",authDomain:"leiturama-40e49.firebaseapp.com",databaseURL:"https://leiturama-40e49.firebaseio.com",projectId:"leiturama-40e49",storageBucket:"leiturama-40e49.appspot.com",messagingSenderId:"697487135295",appId:"1:697487135295:web:5c4d501e75585b13f35e8a"}),p=function(){function e(){var t=this;Object(s.a)(this,e),this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},b.a.initializeApp(v),this.auth=b.a.auth(),this.firestore=b.a.firestore(),this.authUser=null}return Object(l.a)(e,[{key:"doSignUp",value:function(e,t,a,n){this.auth.createUserWithEmailAndPassword(e,t).then((function(e){return a(e)})).catch((function(e){return n(e)}))}},{key:"doSignIn",value:function(e,t,a){this.auth.signInWithEmailAndPassword(e,t).catch(a)}}]),e}(),E=r.a.createContext(null),g=function(e){return function(t){return r.a.createElement(E.Consumer,null,(function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))}))}},C=E,k=p;function O(e){return r.a.createElement("header",null,r.a.createElement("div",null,r.a.createElement(d.b,{to:"/"}," ",r.a.createElement("img",{alt:"imagem da logo",src:a(66),height:"120px"})," ")),r.a.createElement("ul",{className:"navLinks"},r.a.createElement("li",null,r.a.createElement(d.b,{to:"/escola"}," Escola ")),r.a.createElement("li",null,r.a.createElement(d.b,{to:"/professor"}," Professores ")),r.a.createElement("li",null,r.a.createElement(d.b,{to:"/turma"}," Turmas "))),r.a.createElement("div",null,r.a.createElement("a",{href:"#"},r.a.createElement("div",{className:"btnLogout",onClick:function(t){return e.firebase.doSignOut()}},"Sair"))))}function j(e){return r.a.createElement("header",null,r.a.createElement("div",null,r.a.createElement(d.b,{to:"/"}," ",r.a.createElement("img",{alt:"imagem da logo",src:a(66),height:"120px"})," ")),r.a.createElement("ul",{className:"navLinks"},r.a.createElement("li",null,r.a.createElement(d.b,{to:"/turma/professor"}," Turmas ")),r.a.createElement("li",null,r.a.createElement(d.b,{to:"/livros/professor"}," Livros ")),r.a.createElement("li",null,r.a.createElement(d.b,{to:"/registros"}," Registros "))),r.a.createElement("div",null,r.a.createElement("a",{href:"#"},r.a.createElement("div",{className:"btnLogout",onClick:function(t){return e.firebase.doSignOut()}},"Sair"))))}function y(e){return r.a.createElement("header",null,r.a.createElement(d.b,{to:"/"}," ",r.a.createElement("img",{alt:"imagem da logo",src:a(66),height:"120px"})," "),r.a.createElement("ul",{className:"navLinks"},r.a.createElement("li",null,r.a.createElement(d.b,{to:"/download"}," Download APK "))))}var S=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={usuarioLogado:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.authUser?this.props.authUser.profiles.administrator?r.a.createElement(O,{firebase:this.props.firebase}):this.props.authUser.profiles.professor?r.a.createElement(j,{firebase:this.props.firebase}):void 0:r.a.createElement(y,null)}}]),t}(r.a.Component)),P=a(43),w=a(24),U=a(161),L=a(149),A=a(141),D=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={nomeEscola:"",cnpj:"",endereco:""},a.componentDidMount=a.componentDidMount.bind(Object(m.a)(a)),a.onChange=a.onChange.bind(Object(m.a)(a)),a.salvar=a.salvar.bind(Object(m.a)(a)),a.cancelar=a.cancelar.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("Escola - rendered"),r.a.createElement(A.a,{fixed:!0},r.a.createElement("h1",null,"Escola"),r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"iptNomeEscola",name:"nomeEscola",label:"Escola",placeholder:"Nome da escola",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.nomeEscola})),r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"iptCnpjEscola",name:"cnpj",label:"CNPJ",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.cnpj})),r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"iptEndereco",name:"endereco",label:"Endere\xe7o",multiline:!0,rows:"6",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.endereco})),r.a.createElement("div",null,r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.salvar},"Salvar"),"\xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:this.cancelar},"Cancelar")))}},{key:"componentDidMount",value:function(){var e=this;console.log("Escola - componentDidMount"),this.props.firebase.firestore.collection("school").doc("ftHhzHgJB1XTR9dDgbE8").get().then((function(t){if(t.exists){var a=t.data();e.setState(Object(w.a)({},a)),e.initialState=Object(w.a)({},a)}})).catch((function(e){console.log("Escola - Erro na busca dos dados da escola",e)}))}},{key:"onChange",value:function(e){this.setState(Object(P.a)({},e.target.name,e.target.value))}},{key:"salvar",value:function(e){this.props.firebase.firestore.collection("school").doc("ftHhzHgJB1XTR9dDgbE8").set(Object(w.a)({},this.state)).then((function(){console.log("Dados da escola salvos com sucesso")}))}},{key:"cancelar",value:function(e){this.setState(Object(w.a)({},this.initialState))}}]),t}(r.a.Component)),T=a(36),z=function e(){Object(s.a)(this,e),this.adm={email:"",id:"",name:"",phone:""},this.name="",this.members=[]},N=a(150),W=a(153),x=a(151),B=a(154),M=a(152),I=a(51),F=a.n(I),R=a(157),q=a(163),_=a(147),H=a(162),V=function(){function e(t){Object(s.a)(this,e),this.firebase=t,this.getAll=this.getAll.bind(this)}return Object(l.a)(e,[{key:"getAll",value:function(e){var t=[];this.firebase.firestore.collection("user").where("profiles.professor","==",!0).get().then((function(a){a.forEach((function(e){var a=e.data();a.id=e.id,t.push(a)})),e(t)}))}},{key:"atualizar",value:function(e,t,a,n){this.firebase.firestore.collection("user").doc(e).set(t).then(a()).catch(n(n))}},{key:"inserir",value:function(e,t,a){this.firebase.firestore.collection("teachers").add(e).then(t()).catch(a(a))}},{key:"autorizarUsuario",value:function(e,t){this.firebase.firestore.collection("user").doc(e).set(t).then(console.log("user adicionado com sucesso")).catch((function(e){return console.log(e)}))}},{key:"apagarTeacher",value:function(e){this.firebase.firestore.collection("teachers").doc(e).delete().then((function(){console.log("teacher deletado com sucesso")})).catch((function(e){console.log(e)}))}},{key:"carregarDadosIniciaisProfessor",value:function(e,t){this.firebase.firestore.collection("teachers").where("email","==",e).get().then((function(e){if(e.empty)t(null);else{var a=e.docs[0].data();a.id=e.docs[0].id,t(a)}}))}}]),e}(),J=function(){function e(t){Object(s.a)(this,e),this.firebase=t,this.salvar=this.salvar.bind(this),this.atualizar=this.atualizar.bind(this)}return Object(l.a)(e,[{key:"salvar",value:function(e,t){var a={};a.name=e.name,a.members=[],a.adm=e.adm,this.firebase.firestore.collection("library").add(a).then(t).catch((function(e){console.log("Error saving document:",e)}))}},{key:"atualizar",value:function(e,t){this.firebase.firestore.collection("library").doc(e.id).set(e).then((function(){t()})).catch((function(e){console.log("Error updating document:",e)}))}},{key:"getAll",value:function(e){var t=[];this.firebase.firestore.collection("library").get().then((function(a){a.forEach((function(e){var a=e.data();t.push(a)})),e(t)}))}},{key:"getTurmasPorProfessor",value:function(e,t){var a=[];this.firebase.firestore.collection("library").where("adm.id","==",e).get().then((function(e){e.forEach((function(e){var t=e.data();t.id=e.id,a.push(t)})),t(a)}))}},{key:"getAlunoPorTurma",value:function(e,t){this.firebase.firestore.collection("library").doc(e).get().then((function(e){t(e.data())}))}}]),e}(),K=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).persistence=new J(a.props.firebase),a.state={turma:e.turma},a.definirLista=a.definirLista.bind(Object(m.a)(a)),a.confirmarCadastroDados=a.confirmarCadastroDados.bind(Object(m.a)(a)),a.confirmarAtualizacaoDados=a.confirmarAtualizacaoDados.bind(Object(m.a)(a)),a.salvar=a.salvar.bind(Object(m.a)(a)),a.onAdministratorChange=a.onAdministratorChange.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log(this.props.turma),r.a.createElement(A.a,{fixed:!0},r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,required:!0,id:"name",label:"Nome",margin:"normal",variant:"outlined",onChange:this.props.onChange,value:this.props.turma.name})),r.a.createElement("div",null,r.a.createElement(_.a,{fullWidth:!0},r.a.createElement(H.a,{id:"lblAdministrator"},"  Administrador *"),r.a.createElement(R.a,{fullWidth:!0,id:"administrator",label:"Administrador",variant:"outlined",labelId:"lblAdministrator",value:this.props.turma.adm.id,onChange:this.onAdministratorChange},this.state.listaProfessores?this.state.listaProfessores.map((function(e,t){return r.a.createElement(q.a,{value:e.id,key:e.id},e.name)})):null))),r.a.createElement("div",null,r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.salvar},"Salvar")," \xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:this.props.cancelarCadastro},"Cancelar")))}},{key:"componentDidMount",value:function(){new V(this.props.firebase).getAll(this.definirLista)}},{key:"definirLista",value:function(e){this.setState({listaProfessores:e})}},{key:"confirmarCadastroDados",value:function(){console.log("Turma salva com sucesso"),this.props.cancelarCadastro()}},{key:"confirmarAtualizacaoDados",value:function(){console.log("Turma atualizada com sucesso"),this.props.cancelarCadastro()}},{key:"onAdministratorChange",value:function(e){var t=e.target.value,a=this.state.listaProfessores.find((function(e){return e.id===t}));delete a.n_borrowed,delete a.n_lent,delete a.n_read,delete a.profiles;var n=this.state.turma;n.adm=a,this.setState({turma:n})}},{key:"salvar",value:function(e){this.state.turma.id?this.persistence.atualizar(this.state.turma,this.confirmarCadastroDados):this.persistence.salvar(this.state.turma,this.confirmarCadastroDados),this.props.cancelarCadastro()}}]),t}(r.a.Component));function X(e){return r.a.createElement("div",null,r.a.createElement(N.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"Nome"),r.a.createElement(W.a,{align:"center"},"Administrador"))),r.a.createElement(B.a,null,e.listaTurmas.map((function(t,a){return r.a.createElement(M.a,{key:a,id:a,name:a,onDoubleClick:e.onDoubleClick},r.a.createElement(W.a,{align:"center"},t.name),r.a.createElement(W.a,{align:"center"},t.adm.name))})))))}function Y(e){return r.a.createElement("h2",null,"Carregando turmas")}var G=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).turmaPersistence=new J(e.firebase),a.state={cadastrar:!1},a.solicitarCadastro=a.solicitarCadastro.bind(Object(m.a)(a)),a.cancelarCadastro=a.cancelarCadastro.bind(Object(m.a)(a)),a.onChangeDadosTurma=a.onChangeDadosTurma.bind(Object(m.a)(a)),a.definirListaTurmas=a.definirListaTurmas.bind(Object(m.a)(a)),a.solicitarAtualizacao=a.solicitarAtualizacao.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.cadastrar?r.a.createElement(K,{turma:this.state.turma,firebase:this.props.firebase,cancelarCadastro:this.cancelarCadastro,salvar:this.salvar,onChange:this.onChangeDadosTurma}):this.state.turmas?r.a.createElement("div",null,r.a.createElement(F.a,{onClick:this.solicitarCadastro}),this.state.turmas.length>0?r.a.createElement(X,{listaTurmas:this.state.turmas,onDoubleClick:this.solicitarAtualizacao}):r.a.createElement("h2",null,"N\xe3o h\xe1 turmas cadastradas")):r.a.createElement("div",null,r.a.createElement(F.a,{onClick:this.solicitarCadastro}),r.a.createElement(Y,null))}},{key:"onChangeDadosTurma",value:function(e){var t=e.target.id,a=e.target.value,n=this.state.turma;n[t]=a,this.setState({turma:n})}},{key:"solicitarCadastro",value:function(){var e=new z;this.setState({cadastrar:!0,turma:e})}},{key:"solicitarAtualizacao",value:function(e){var t=e.currentTarget.id,a=this.state.turmas[t];console.log(a),this.setState({cadastrar:!0,turma:a})}},{key:"cancelarCadastro",value:function(){this.setState({cadastrar:!1})}},{key:"definirListaTurmas",value:function(e){this.setState({turmas:e})}},{key:"componentDidMount",value:function(){this.turmaPersistence.getAll(this.definirListaTurmas)}}]),t}(r.a.Component)),Q=a(85),Z=a.n(Q);function $(e){return r.a.createElement("h2",null,"Carregando turmas")}var ee=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.turmaPersistence=new J(e.firebase),a.definirListaTurmas=a.definirListaTurmas.bind(Object(m.a)(a)),a.selecionarTurma=a.selecionarTurma.bind(Object(m.a)(a)),a.copyToClipboard=a.copyToClipboard.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.state.visualizarAlunos&&this.state.turma?r.a.createElement(T.a,{to:"/turma/alunos?turma="+this.state.turma.id}):this.state.turmas?this.state.turmas.length?r.a.createElement(N.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"Administrador"),r.a.createElement(W.a,{align:"center"},"Nome"),r.a.createElement(W.a,{align:"center"},"Convite"),r.a.createElement(W.a,{align:"center"},"Alunos"))),r.a.createElement(B.a,null,this.state.turmas.map((function(t,a){return r.a.createElement(M.a,{key:a,id:a,name:a},r.a.createElement(W.a,{align:"center"}," ",t.name," "),r.a.createElement(W.a,{align:"center"}," ",t.adm.name," "),r.a.createElement(W.a,{align:"center"},r.a.createElement("input",{id:"link"+t.id,value:"https://leiturama.page.link/?link="+encodeURIComponent("https://leituramaescola.com/"+t.id).replace("%20","+")+"&apn="+encodeURIComponent("com.arthur.leituramaescola").replace("%20","+")+"&afl="+encodeURIComponent(window.location.origin.toString()+"/download").replace("%20","+")}),r.a.createElement("button",{id:"btn"+t.id,onClick:e.copyToClipboard}," Convidar ")),r.a.createElement(W.a,{align:"center"},r.a.createElement(Z.a,{id:a,onClick:e.selecionarTurma})))})))):r.a.createElement("div",null," ",r.a.createElement("h2",null,"N\xe3o h\xe1 turmas cadastradas")," "):r.a.createElement("div",null," ",r.a.createElement($,null)," ")}},{key:"selecionarTurma",value:function(e){var t=e.target.id,a=this.state.turmas[t],n=a?a.members:[];console.log(n),this.setState({visualizarAlunos:!0,turma:a})}},{key:"definirListaTurmas",value:function(e){this.setState({turmas:e})}},{key:"componentDidMount",value:function(){var e=this.props.authUser.id;this.turmaPersistence.getTurmasPorProfessor(e,this.definirListaTurmas)}},{key:"copyToClipboard",value:function(e){var t=e.target.id.substr(3);document.getElementById("link"+t).select(),document.execCommand("copy"),console.log("somente um teste")}}]),t}(r.a.Component)),te=G,ae=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).dao=new V(e.firebase),a.onClick=a.onClick.bind(Object(m.a)(a)),a.onDoubleClick=a.onDoubleClick.bind(Object(m.a)(a)),a.componentDidMount=a.componentDidMount.bind(Object(m.a)(a)),a.onRequestTeacherUpdate=a.onRequestTeacherUpdate.bind(Object(m.a)(a)),a.state={cadastrarProfessor:!1,atualizarProfessor:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.state.cadastrar?r.a.createElement(T.a,{to:"/professor?cadastrar=true"}):this.state.atualizar?r.a.createElement(T.a,{to:"/professor?indice="+this.state.indice}):r.a.createElement("div",null,r.a.createElement("div",{onClick:this.onClick},r.a.createElement(F.a,null)),r.a.createElement(N.a,{"aria-label":"customized table"},r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"Nome"),r.a.createElement(W.a,{align:"center"},"Email"),r.a.createElement(W.a,{align:"center"},"Telefone"))),r.a.createElement(B.a,null,this.state.lista?this.state.lista.map((function(t,a){return r.a.createElement(M.a,{id:a,onDoubleClick:e.onDoubleClick,key:a},r.a.createElement(W.a,{align:"center"}," ",t.name," "),r.a.createElement(W.a,{align:"center"}," ",t.email," "),r.a.createElement(W.a,{align:"center"}," ",t.phone," "))})):null)))}},{key:"onClick",value:function(e){this.setState({cadastrar:!0,atualizar:!1})}},{key:"onDoubleClick",value:function(e){var t=e.currentTarget.id;this.setState({cadastrar:!1,atualizar:!0,indice:t})}},{key:"componentDidMount",value:function(){var e=this;this.dao.getAll((function(t){e.props.definirLista(t),e.setState({lista:t})}))}},{key:"onRequestTeacherUpdate",value:function(e){this.setState({indice:e.target.id,cadastrar:!1,atualizar:!0})}}]),t}(r.a.Component)),ne=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).initialState={mudarPagina:!1,professor:{name:"",email:"",phone:""}},a.state=Object(w.a)({},a.initialState),a.onChange=a.onChange.bind(Object(m.a)(a)),a.salvar=a.salvar.bind(Object(m.a)(a)),a.cancelar=a.cancelar.bind(Object(m.a)(a)),a.dao=new V(a.props.firebase),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("Professor - Cadastro - rendered"),console.log(this.state),this.state.mudarPagina?r.a.createElement(T.a,{to:"/professor"}):r.a.createElement(A.a,{fixed:!0},r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"name",name:"name",label:"Nome",placeholder:"Nome do professor",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.professor.name})),r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"email",name:"email",label:"E-mail",placeholder:"E-mail do professor",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.professor.email})),r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"phone",name:"phone",label:"Telefone",margin:"normal",variant:"outlined",onChange:this.onChange,value:this.state.professor.phone})),r.a.createElement("div",null,r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.salvar},"Salvar"),"\xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:this.cancelar},"Cancelar")))}},{key:"componentDidMount",value:function(){if(this.props.lista){var e=this.props.lista[this.props.indice];console.log("didMount Cadastro"),console.log(e),console.log("didMount Cadastro"),this.setState({professor:e})}}},{key:"onChange",value:function(e){var t=this.state.professor;t[e.target.name]=e.target.value,this.setState({professor:t})}},{key:"cancelar",value:function(e){this.setState({mudarPagina:!0})}},{key:"salvar",value:function(e){var t=this,a=Object(w.a)({},this.state.professor),n=a.id;delete a.id,delete a.mudarPagina,n?this.dao.atualizar(n,a,(function(){console.log("Dados do professor atualizados com sucesso"),t.setState({mudarPagina:!0})}),(function(e){return console.log(e.message)})):this.dao.inserir(a,(function(){console.log("Dados do professor atualizados com sucesso"),t.setState({mudarPagina:!0})}),(function(e){return console.log(e.message)})),this.props.firebase.firestore.collection("teachers").add(a).then((function(){console.log("Dados do professor salvos com sucesso"),t.setState({mudarPagina:!0})}))}}]),t}(r.a.Component)),re=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).definirListaProfessores=a.definirListaProfessores.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(console.log("Professores - render"),this.props.location.search){if("?indice="===this.props.location.search.substr(0,8)){var e=this.props.location.search.substr(8);return r.a.createElement(ne,{lista:this.state.lista,indice:e})}return r.a.createElement(ne,null)}return r.a.createElement(ae,{definirLista:this.definirListaProfessores})}},{key:"definirListaProfessores",value:function(e){this.setState({lista:e})}}]),t}(r.a.Component)),ie=(a(114),a(160)),oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state=Object(w.a)({},se),a.onChange=a.onChange.bind(Object(m.a)(a)),a.cancelar=a.cancelar.bind(Object(m.a)(a)),a.autenticar=a.autenticar.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(A.a,{fixed:!0},r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"email",name:"email",label:"E-mail",placeholder:"email",margin:"normal",variant:"outlined",value:this.state.usuario,onChange:this.onChange})),r.a.createElement("div",null,r.a.createElement(_.a,{variant:"outlined",fullWidth:!0},r.a.createElement(H.a,{htmlFor:"outlined-adornment-password"},"Password"),r.a.createElement(ie.a,{id:"senha",type:"password",value:this.state.senha,onChange:this.onChange,labelWidth:70})),r.a.createElement(d.b,{to:"/esqueci_senha"},"Esqueci a senha")," ",r.a.createElement("br",null),r.a.createElement(d.b,{to:"/professor/primeiroacesso"},"\xc9 seu primeiro acesso professor?")),r.a.createElement("div",{className:"confirmationControl"},r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.autenticar},"Autenticar"),"\xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:this.cancelar},"Limpar")))}},{key:"onChange",value:function(e){this.setState(Object(P.a)({},e.target.id,e.target.value))}},{key:"cancelar",value:function(){this.setState(Object(w.a)({},se))}},{key:"autenticar",value:function(){this.props.firebase.doSignIn(this.state.email,this.state.senha,this.handleAuthenticationError)}},{key:"handleAuthenticationError",value:function(e){console.log("==================================="),console.log(e),console.log(e.message),console.log("===================================")}}]),t}(r.a.Component),se={email:"",senha:""},le=g(oe),ce=g(function(e){function t(e){var a;return Object(s.a)(this,t),console.log("FrmEsqueciSenha - constructor"),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={email:"",msg:""},a.onChange=a.onChange.bind(Object(m.a)(a)),a.resetar=a.resetar.bind(Object(m.a)(a)),a.cancelar=a.cancelar.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.encerrar?r.a.createElement(T.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement(U.a,{fullWidth:!0,id:"email",name:"email",label:"E-mail",placeholder:"E-mail",margin:"normal",variant:"outlined",value:this.state.email,onChange:this.onChange}),r.a.createElement("div",{className:"confirmationControl"},r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.resetar},"Resetar"),"\xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:this.cancelar},"Cancelar"))),this.state.msg?this.state.msg:"")}},{key:"onChange",value:function(e){this.setState({email:e.target.value})}},{key:"resetar",value:function(e){var t=this;this.props.firebase.doPasswordReset(this.state.email).then((function(){t.setState({email:"",msg:"Um email foi enviado para "+t.state.email+" com instru\xe7\xf5es para recuperar sua senha"}),t.setState({encerrar:!0})})).catch((function(e){console.log("falha"),"auth/user-not-found"===e.code?t.setState({msg:"Email n\xe3o encontrado"}):"auth/invalid-email"===e.code?t.setState({msg:"Email inv\xe1lido"}):t.setState({msg:"Falha na opera\xe7\xe3o"})}))}},{key:"cancelar",value:function(){this.setState({encerrar:!0})}},{key:"componentDidMount",value:function(){}}]),t}(r.a.Component)),ue=le,me=a(159),he=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).daoProfessor=new V(a.props.firebase),a.state={user:Object(w.a)({},de)},a.onChange=a.onChange.bind(Object(m.a)(a)),a.onPasswdChange=a.onPasswdChange.bind(Object(m.a)(a)),a.carregarDadosProfessor=a.carregarDadosProfessor.bind(Object(m.a)(a)),a.onClick=a.onClick.bind(Object(m.a)(a)),a.registerUser=a.registerUser.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement(A.a,{fixed:!0},r.a.createElement(U.a,{fullWidth:!0,id:"email",name:"email",label:"E-mail",placeholder:"email",margin:"normal",variant:"outlined",value:this.state.user.email,onChange:this.onChange}),r.a.createElement("br",null),this.state.user.name?r.a.createElement("div",null,r.a.createElement(U.a,{fullWidth:!0,id:"name",name:"name",label:"Nome",placeholder:"Nome",margin:"normal",variant:"outlined",value:this.state.user.name,onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(U.a,{fullWidth:!0,id:"phone",name:"phone",label:"Telefone",placeholder:"Telefone",margin:"normal",variant:"outlined",value:this.state.user.phone,onChange:this.onChange}),r.a.createElement("br",null),r.a.createElement(_.a,{variant:"outlined",fullWidth:!0},r.a.createElement(H.a,{htmlFor:"outlined-adornment-password"},"Password"),r.a.createElement(ie.a,{id:"senha",type:"password",value:this.state.password,onChange:this.onPasswdChange,labelWidth:70}))):null,r.a.createElement("div",{className:"confirmationControl"},r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:this.onClick}," Iniciar "),"\xa0",r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:function(t){return e.setState({user:Object(w.a)({},de)})}},"Limpar")),r.a.createElement(me.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.errorMessage,autoHideDuration:1e3,onClose:function(){return e.setState({errorMessage:null})},message:this.state.errorMessage}))}},{key:"showMessage",value:function(e){}},{key:"onPasswdChange",value:function(e){var t=e.target.value;this.setState({senha:t})}},{key:"onChange",value:function(e){var t=e.target.value,a=e.target.id,n=this.state.user;n[a]=t,this.setState({user:n})}},{key:"registerUser",value:function(e){var t=e.user.uid,a=this.state.teacherId,n=this.state.user;n.id=t,this.daoProfessor.autorizarUsuario(t,n),this.daoProfessor.apagarTeacher(a)}},{key:"onClick",value:function(e){var t=this;if(this.state.user.name){var a=this.state.user.email,n=this.state.senha;this.props.firebase.doSignUp(a,n,this.registerUser,(function(e){return console.log(e)}))}else this.daoProfessor.carregarDadosIniciaisProfessor(this.state.user.email,(function(e){if(e){var a=e.id;delete e.id;var n=t.state.user;t.setState({teacherId:a,user:Object(w.a)({},n,{},e)})}else t.setState({errorMessage:"Usu\xe1rio inexistente"})}))}},{key:"carregarDadosProfessor",value:function(e){}}]),t}(r.a.Component)),de={name:"",n_borrowed:0,n_lent:0,n_read:0,email:"",phone:"",profiles:{professor:!0}},fe=he,be=function(){function e(t){Object(s.a)(this,e),this.firebase=t,this.getLivros=this.getLivros.bind(this),this.getLivrosPorProfessor=this.getLivrosPorProfessor.bind(this)}return Object(l.a)(e,[{key:"updateBook",value:function(e,t,a){this.firebase.firestore.collection("books").doc(e.id).set(e).then(t,(function(e){return a(e)}))}},{key:"getLivrosPorProfessor",value:function(e,t){new J(this.firebase).getTurmasPorProfessor(e,t)}},{key:"getLivros",value:function(e,t){var a=this,n=[];e.forEach((function(e){e.members&&e.members.forEach((function(e){n.find((function(t){return t.id===e.id}))||n.push(e)}))}));var r=[];n.forEach((function(e){a.firebase.firestore.collection("books").where("owner.id","==",e.id).get().then((function(e){e.empty||(e.docs.forEach((function(e){var t=e.data();t.id=e.id,r.push(t)})),t(r))}))}))}}]),e}(),ve=a(155),pe=a(156),Ee=a(86),ge=a.n(Ee),Ce=a(58),ke=a.n(Ce),Oe=a(87),je=a.n(Oe);function ye(e){function t(){a.inactive=!a.inactive,n.updateBook(a,e.confirmUpdate)}var a=e.book,n=e.daoLivro;return a.inactive?r.a.createElement(L.a,{variant:"contained",color:"primary",onClick:t},"Ativar"):r.a.createElement(L.a,{variant:"contained",color:"secondary",onClick:t},"Desativar")}function Se(e){return r.a.createElement(ve.a,{value:e.estadoLivros,showLabels:!0,onChange:e.onChange},r.a.createElement(pe.a,{value:"ALL",label:"Todos",icon:r.a.createElement(ge.a,null)}),r.a.createElement(pe.a,{value:"AVAILABLE",label:"Dispon\xedveis",icon:r.a.createElement(je.a,null)}),r.a.createElement(pe.a,{value:"RENT",label:"Emprestados",icon:r.a.createElement(ke.a,null)}))}var Pe=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={estadoLivros:"ALL",livrosSemFiltro:[],livros:[]},a.dao=new be(a.props.firebase),a.onChangeBookFilter=a.onChangeBookFilter.bind(Object(m.a)(a)),a.onChangeTermoPesquisado=a.onChangeTermoPesquisado.bind(Object(m.a)(a)),a.confirmarAtualizacao=a.confirmarAtualizacao.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.state.livrosSemFiltro?r.a.createElement(A.a,{fixed:!0},r.a.createElement(Se,{estadoLivros:this.state.estadoLivros,onChange:this.onChangeBookFilter}),r.a.createElement(U.a,{fullWidth:!0,id:"edtTitle",label:"Pesquisar",placeholder:"Digite o t\xedtulo desejado",margin:"normal",variant:"outlined",onChange:this.onChangeTermoPesquisado,value:this.state.termoPesquisado}),r.a.createElement(N.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"Mudar status"),r.a.createElement(W.a,{align:"center"},"T\xedtulo"),r.a.createElement(W.a,{align:"center"},"Propriet\xe1rio"),r.a.createElement(W.a,{align:"center"},"Status"),"RENT"===this.state.estadoLivros?r.a.createElement(W.a,{align:"center"},"Devolver"):null)),r.a.createElement(B.a,null,this.state.livros.map((function(t,a){return r.a.createElement(M.a,{key:a,id:a,name:a},r.a.createElement(W.a,{align:"center"}," ",r.a.createElement(ye,{book:t,daoLivro:e.dao,confirmUpdate:e.confirmarAtualizacao})," "),r.a.createElement(W.a,{align:"center"}," ",t.title," "),r.a.createElement(W.a,{align:"center"}," ",t.owner.name),r.a.createElement(W.a,{align:"center"}," ",t.status),"RENT"===e.state.estadoLivros?r.a.createElement(W.a,{align:"center"},r.a.createElement(L.a,{variant:"outlined",color:"secondary"},"Devolver")):null)}))))):r.a.createElement("h1",null,"Carregando livros")}},{key:"onChangeTermoPesquisado",value:function(e){var t=e.target.value;if(t.length<3){var a=this.state.livrosSemFiltro;this.setState({livros:a})}else{var n=this.state.livrosSemFiltro.filter((function(e){return e.title.startsWith(t)}));this.setState({livros:n})}}},{key:"onChangeBookFilter",value:function(e,t){"ALL"===t?this.setState({estadoLivros:t,livros:this.state.allBooks,livrosSemFiltro:this.state.allBooks}):"AVAILABLE"===t?this.setState({estadoLivros:t,livros:this.state.availableBooks,livrosSemFiltro:this.state.availableBooks}):this.setState({estadoLivros:t,livros:this.state.rentBooks,livrosSemFiltro:this.state.rentBooks})}},{key:"confirmarAtualizacao",value:function(){this.setState({lastUpdate:Date.now()})}},{key:"componentDidMount",value:function(){var e=this;this.dao.getLivrosPorProfessor(this.props.authUser.id,(function(t){e.dao.getLivros(t,(function(t){var a=t,n=[],r=[],i=a;t.forEach((function(e){"AVAILABLE"===e.status?n.push(e):r.push(e)})),e.setState({allBooks:a,availableBooks:n,rentBooks:r,livros:i,livrosSemFiltro:i})}))}))}}]),t}(r.a.Component)),we=function(){function e(t){Object(s.a)(this,e),this.firebase=t}return Object(l.a)(e,[{key:"getRegistros",value:function(e,t){var a=this,n=[];e.forEach((function(e){a.firebase.firestore.collection("registers").where("book.id","==",e.id).get().then((function(e){e.empty||(e.docs.forEach((function(e){var t=e.data();t.id=e.id,n.push(t)})),t(n))}))}))}}]),e}(),Ue=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.daoLivro=new be(a.props.firebase),a.dao=new we(a.props.firebase),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.registros?this.state.registros.length?r.a.createElement(A.a,null,r.a.createElement(N.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"T\xedtulo"),r.a.createElement(W.a,{align:"center"},"Propriet\xe1rio"),r.a.createElement(W.a,{align:"center"},"Evento"))),r.a.createElement(B.a,null,this.state.registros.map((function(e,t){return r.a.createElement(M.a,{key:t,id:t,name:t},r.a.createElement(W.a,{align:"center"}," ",e.book.title," "),r.a.createElement(W.a,{align:"center"}," ",e.book.owner.name," "),r.a.createElement(W.a,{align:"center"}," ",e.libraryEvent," "))}))))):r.a.createElement("h1",null,"N\xe3o h\xe1 registros"):r.a.createElement("h1",null,"Carregando registros")}},{key:"componentDidMount",value:function(){var e=this;this.daoLivro.getLivrosPorProfessor(this.props.authUser.id,(function(t){e.daoLivro.getLivros(t,(function(t){e.dao.getRegistros(t,(function(t){return e.setState({registros:t})}))}))}))}}]),t}(r.a.Component)),Le=function(){function e(t){Object(s.a)(this,e),this.firebase=t}return Object(l.a)(e,[{key:"updateUser",value:function(e,t,a){this.firebase.firestore.collection("user").doc(e.id).set(e).then(t).catch((function(e){return a(e)}))}},{key:"findUser",value:function(e,t,a){this.firebase.firestore.collection("user").doc(e).get().then((function(e){return t(e.data())})).catch((function(e){return a(e)}))}}]),e}(),Ae=a(88),De=a.n(Ae);function Te(e){return e.member.inactive?r.a.createElement(ke.a,null):r.a.createElement(De.a,null)}function ze(e){function t(){var t=e.member;t.inactive=!t.inactive,e.daoUser.updateUser(t,e.confirm,(function(e){return console.log(e.message)}))}return e.member.inactive?r.a.createElement("span",{onClick:t},"Ativar"):r.a.createElement("span",{onClick:t},"Desativar")}var Ne=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.daoTurma=new J(a.props.firebase),a.daoUser=new Le(a.props.firebase),a.confirmUpdate=a.confirmUpdate.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.location.search&&"?turma="===this.props.location.search.substr(0,7)?this.state.users?this.state.users.length?r.a.createElement(A.a,{fixed:!0},r.a.createElement("h1",null,this.state.turma.name),r.a.createElement(N.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(W.a,{align:"center"},"Nome"),r.a.createElement(W.a,{align:"center"},"Email"),r.a.createElement(W.a,{align:"center"},"Estado"),r.a.createElement(W.a,{align:"center"},"A\xe7\xe3o"))),r.a.createElement(B.a,null,this.state.users.map((function(t,a){return r.a.createElement(M.a,{key:a,id:a,name:a},r.a.createElement(W.a,{align:"center"},t.name),r.a.createElement(W.a,{align:"center"},t.email),r.a.createElement(W.a,{align:"center"}," ",r.a.createElement(Te,{member:t})," "),r.a.createElement(W.a,{align:"center"},r.a.createElement(ze,{member:t,daoUser:e.daoUser,confirm:e.confirmUpdate})))}))))):r.a.createElement("h1",null,"Turma n\xe3o cont\xe9m membros"):r.a.createElement("h1",null,"Carregando dados dos alunos"):r.a.createElement(T.a,{to:"/turma/professor"})}},{key:"componentDidMount",value:function(){var e=this,t=[],a=this.props.location.search.substr(7);this.daoTurma.getAlunoPorTurma(a,(function(a){e.setState({turma:a}),a.members.forEach((function(a){return e.daoUser.findUser(a.id,(function(a){t.push(a),e.setState({users:t})}),(function(e){return console.log(e)}))}))}),(function(e){return console.log(e)}))}},{key:"confirmUpdate",value:function(){this.setState({ultimaAtualizacao:Date.now()})}}]),t}(r.a.Component)),We=a(89),xe=a.n(We),Be=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(A.a,{fixed:!0},r.a.createElement("center",null,r.a.createElement("div",null,r.a.createElement("h1",null,"Download apk Leiturama"),r.a.createElement("a",{target:"_blank",href:"https://drive.google.com/file/d/1upBYCfHVX6ubOxxO6lHNVfF3Kj9pC8Fz/view?usp=sharing"},r.a.createElement(xe.a,null)))))}}]),t}(r.a.Component);function Me(){return r.a.createElement("h1",null," Home ")}var Ie=g(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){a.listener=a.props.firebase.auth.onAuthStateChanged((function(e){e?a.props.firebase.firestore.collection("user").doc(e.uid).get().then((function(e){if(e.exists){var t=e.data();a.setState({authUser:t})}else console.log("Usu\xe1rio n\xe3o autorizado pelo sistema")})).catch((function(e){console.log("Error getting document:",e)})):a.setState({authUser:null})}))},a.state={authUser:null},a.setAuthUser=a.setAuthUser.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.authUser?this.state.authUser.profiles.administrator?r.a.createElement(A.a,{maxWidth:"lg",className:"app"},r.a.createElement(d.a,null,r.a.createElement(S,{authUser:this.state.authUser}),r.a.createElement(T.d,null,r.a.createElement(T.b,{path:"/",exact:!0,component:Me}),r.a.createElement(T.b,{path:"/escola",component:D}),r.a.createElement(T.b,{path:"/professor",component:re}),r.a.createElement(T.b,{path:"/turma",component:te})))):this.state.authUser.profiles.professor?r.a.createElement(A.a,{maxWidth:"lg",className:"app"},r.a.createElement(d.a,null,r.a.createElement(S,{authUser:this.state.authUser}),r.a.createElement(T.d,null,r.a.createElement(T.b,{path:"/",exact:!0,component:Me}),r.a.createElement(T.b,{path:"/turma/professor"},r.a.createElement(ee,{authUser:this.state.authUser})),r.a.createElement(T.b,{path:"/livros/professor",exact:!0},r.a.createElement(Pe,{authUser:this.state.authUser})),r.a.createElement(T.b,{path:"/registros"},r.a.createElement(Ue,{authUser:this.state.authUser})),r.a.createElement(T.b,{path:"/turma/alunos",component:Ne})))):this.state.authUser.profiles.student?r.a.createElement("div",null,"Aluno n\xe3o possui funcionalidades na plataforma Web"):void 0:r.a.createElement(A.a,{maxWidth:"lg",className:"app"},r.a.createElement(d.a,null,r.a.createElement(S,{authUser:this.state.authUser}),r.a.createElement(T.d,null,r.a.createElement(T.b,{path:"/esqueci_senha",component:ce}),r.a.createElement(T.b,{path:"/professor/primeiroacesso",component:fe}),r.a.createElement(T.b,{path:"/download",component:Be}),r.a.createElement(T.b,{path:"/",component:ue}))))}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"setAuthUser",value:function(e){this.setState({authUser:e})}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(C.Provider,{value:new k},r.a.createElement(Ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},66:function(e,t,a){e.exports=a.p+"static/media/logo.b518f3af.png"},78:function(e,t,a){},98:function(e,t,a){e.exports=a(115)}},[[98,1,2]]]);
//# sourceMappingURL=main.b0e75659.chunk.js.map